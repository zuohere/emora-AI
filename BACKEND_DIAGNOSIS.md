后端数据接收诊断清单
=====================

🔍 你应该检查的事项：

1. **WebSocket 服务器是否运行？**
   - 地址: ws://10.10.40.54:8900/ws
   - 验证: 在你的后端机器上，检查该地址是否可访问
   - 测试: 尝试 `curl -i -N -H "Connection: Upgrade" -H "Upgrade: websocket" ws://10.10.40.54:8900/ws`

2. **应用连接状态日志**
   - 在 Xcode 控制台中查找这些日志：
     ✅ "WebSocket 连接成功"
     ✅ "Meta适配器已启动"
     ✅ "视频捕获已启动"
     ✅ "音频引擎已启动"
   
3. **数据发送日志**
   - 查找这些日志（应该持续出现）：
     ✅ "发送视频数据: xxx bytes"
     ✅ "发送音频数据: xxx bytes"
     ✅ "WebSocket数据已发送: xxx bytes"

4. **后端接收到的数据格式**
   - 视频数据格式:
     {
       "type": "video_frame",
       "is_keyframe": true/false,
       "data": "base64编码的H264数据"
     }
   
   - 音频数据格式:
     {
       "type": "audio_chunk",
       "data": "base64编码的音频数据"
     }

5. **常见问题排查**
   □ WebSocket 连接失败？
     - 检查 IP 地址 10.10.40.54 是否正确
     - 检查端口 8900 是否开放
     - 检查防火墙设置
   
   □ 连接成功但没收到数据？
     - 检查 "开始采集" 按钮是否被点击（UI 应显示 "采集中"）
     - 检查应用是否有摄像头和麦克风权限
     - 查看 Xcode 控制台是否有 H264编码失败的错误
   
   □ 看到编码失败错误？
     - 这已经在代码中修复，重新编译应用

6. **网络调试（如果需要）**
   - 在后端添加日志来查看是否有连接请求
   - 使用 Wireshark 抓包查看网络流量
   - 确保后端的 WebSocket 路由是正确的

💡 建议步骤：
1. 运行应用并查看 Xcode 控制台
2. 确认看到 "WebSocket 连接成功" 和 "Meta适配器已启动"
3. 点击 "开始采集" 按钮
4. 查看是否有 "发送视频数据" 和 "发送音频数据" 的日志
5. 检查后端是否收到对应的数据

